\input{include/algorithms/probabilistic-solution.tex}
Now we turn to the stochastic scenario, that is, $\vu$ is no longer deterministic but random, and apply the general framework for uncertainty analysis presented in \sref{uncertainty-analysis} to a particular quantity of interest $\w$.
Specifically, $\w$ is now the temperature profile $\mQ$ corresponding to a given $\mP_\dynamic$.
Since $\mQ$ is an $\nprocs \times \nsteps$ matrix, following \rref{multiple-dimensions}, $\w$ is viewed as an $\nprocs \nsteps$-dimensional row vector, in which case each coefficient $\coefficient{\w}_{\multiindex}$ in \eref{spectral-decomposition} is also such a vector.
Then the projection in \eref{coefficient-evaluation} should be interpreted as follows.
$\vw$ is an $\nqorder \times \nprocs \nsteps$ matrix, and the $i$th row of this matrix is the temperature profile computed at the $i$th quadrature point and reshaped into a row vector.
Similarly, $\coefficient{\vw}$ is an $\ncorder \times \nprocs \nsteps$ matrix, and the $i$th row of this matrix is the $i$th expansion coefficient $\coefficient{\w}_{\multiindex_i}$ (recall that a certain ordering is assumed to be imposed on the multi-indices).

The pseudocode of the procedure is given in \aref{probabilistic-solution} wherein the output of \aref{deterministic-solution} is implicitly reshaped into a row vector.
Having obtained $\vw$, the corresponding spectral decomposition in \eref{spectral-decomposition} boils down to one matrix multiplication of the (precomputed and tabulated) projection matrix $\projection$ and $\vw$ since the coefficients packed in $\coefficient{\vw}$ are the only unknowns.
Now the constructed expansion can be post-processed as needed; see \sref{post-processing}.
For example, the row of $\coefficient{\vw}$ corresponding to the zero multi-index $\vZero$ (naturally, it is the first row) is a flattened version of the expected value of $\mQ$ as shown in \eref{probabilistic-moments}.
