A robust and computationally efficient solution of \eref{temperature-model} for a given $\o \in \outcomes$, or equivalently for a given $\u(\o)$, is an essential part of our probabilistic framework.
In order to attain such a solution, we utilize a numerical method from the family of so-called exponential integrators \cite{hochbruck2010}.
The procedure is described in \xref{temperature-model}, and here we only use the final result; see also \cite{ukhov2012}.

Recall that we are to analyze a dynamic power profile $\mP_\dynamic$ covering a time interval $[0, \period]$ with $\nsteps$ samples that are evenly spaced in time.
The transient solution of \eref{temperature-model-inner} is reduced to the following recurrence for $k = 1, \dots, \nsteps$:
\begin{equation} \elabel{recurrence}
  \vX_k = \mE \: \vX_{k - 1} + \mF \: \vP_k
\end{equation}
where the subscript $k$ stands for time $k \dt$, $\vX_0 = \vZero$,
\[
  \mE = e^{\mA \dt}, \hspace{1em} \text{and} \hspace{1em} \mF = \mA^{-1} (e^{\mA \dt} - \mI) \: \mB.
\]
For computational efficiency, the state matrix $\mA$ is factorized using the eigenvalue decomposition as follows \cite{press2007}:
\begin{equation} \elabel{eigenvalue-decomposition}
  \mA = \mV \mL \mV^T
\end{equation}
where $\mV$ and $\mL = \diag{\lambda_i}$ are an orthogonal matrix of the eigenvectors and a diagonal matrix of the eigenvectors of $\mA$, respectively.
The matrices $\mE$ and $\mF$ are then
\begin{align*}
  & \mE = \mV \; \diag{e^{\lambda_i \dt}} \mV^T \text{ and} \\
  & \mF = \mV \; \diag{ \frac{e^{\lambda_i \dt} - 1}{\lambda_i} } \mV^T \mB.
\end{align*}
To sum up, the derivation up to this point is sufficient to for the \tta\ via \eref{recurrence} followed by \eref{temperature-model-outer}.
\begin{remark}
Although we always refer to temperature, each temperature analysis developed in this paper is essentially accompanied by the corresponding power analysis as the two are inseparable due to the leakage-temperature interplay.
Consequently, when it is appropriate, one can easily extract only the (temperature-aware) power part of the presented solutions.
\end{remark}

Let us move on to the \dss\ case.
Assume for now that $\vP_\static$ in \eref{power-model} does not depend on $\vQ$, \ie, there is no interdependency between leakage and temperature.
The \dss\ boundary condition is
\[
  \vX_1 = \vX_{\nsteps + 1}.
\]
This constraint and \eref{recurrence} yield a block-circulant system of $\nnodes \nsteps$ linear equations with $\nnodes \nsteps$ unknowns.
As shown in \cite{ukhov2012}, this problem can be efficiently solved by exploiting the particular structure of the system and the decomposition in \eref{eigenvalue-decomposition}.
The pseudo code of this algorithm, which delivers the exact solution under the made assumptions, is given in \aref{deterministic-solution}.\footnote{Hereafter, we utilize MATLAB's notations $\m{A}(k, :)$ and $\m{A}(:, k)$ to refer to the $k$th row and the $k$th column of a matrix $\m{A}$, respectively.
Also, in pseudo codes, we shall underline auxiliary vectors and matrices, \eg, $\tmp{\v{a}}$ and $\tmp{\m{A}}$.}
\input{include/algorithms/deterministic-solution.tex}

In \aref{deterministic-solution}, all the involved matrices have already been defined except for $\mQ_\ambient$, which is a matrix of the ambient temperature.
The time complexity of direct solutions of the system is $\bigO(\nsteps^3 \nnodes^3)$ while the one of \aref{deterministic-solution} is only $\bigO(\nsteps \nnodes^2 + \nnodes^3)$.\footnote{The complexity reported in \cite{ukhov2012} is erroneously overestimated to $\bigO(\nsteps \nnodes^3)$.}

Let us now bring the leakage-temperature interdependence into the picture.
To this end, we repeat \aref{deterministic-solution} for a sequence of total power profiles $\{ \mP_k = \mP_\dynamic + \mP_{\static, k} \}$ wherein the static part $\mP_{\static, k}$ is being updated using \eref{power-model} given the temperature profile $\mQ_{k - 1}$ computed at the previous iteration starting from the ambient temperature.
The procedure stops when the sequence of temperature profiles $\{ \mQ_k \}$ converges in an appropriate norm, or some other stopping condition is satisfied (\eg, a maximal temperature constraint is violated).
This procedure is illustrated in \aref{deterministic-solution-with-leakage}.
\input{include/algorithms/deterministic-solution-with-leakage.tex}

In \aref{deterministic-solution-with-leakage}, $\mP_\static(\mQ, \u)$ should be understood as a call to a subroutine that returns an $\nprocs \times \nsteps$ matrix wherein the $(i, j)$th element is the static component of the power dissipation of the $i$th processing element at the $j$th moment of time with respect to the temperature given by the $(i, j)$th element of $\mQ$ and $\u$.

\begin{remark}
A wide-spread approach to account for the leakage-temperature interdependence is to linearize it with respect to temperature.
As shown in \cite{liu2007}, already with one linear segment, this approximation can deliver sufficiently accurate results.
One remarkable feature of such a linearization is that no looping-until-convergence is needed in this case; see \cite{ukhov2012}.
However, this approach assumes that the only varying parameter of leakage is temperature, in which case it is relatively easy to decide on a representative temperature range and undertake a one-dimensional curve-fitting procedure with respect to it.
In our case, the power model has multiple parameters stepping far from their nominal values, making it difficult, if ever possible, to construct a good linear fit with respect to temperature.
\end{remark}
